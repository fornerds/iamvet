# 클라이언트 설정 가이드

AWS와 OAuth 서비스 설정을 변경하는 방법입니다.

## 📋 목차

1. [AWS Route 53 DNS 설정](#1-aws-route-53-dns-설정)
2. [카카오 개발자 콘솔 설정](#2-카카오-개발자-콘솔-설정)
3. [구글 클라우드 콘솔 설정](#3-구글-클라우드-콘솔-설정)
4. [네이버 개발자 센터 설정](#4-네이버-개발자-센터-설정)
5. [설정 확인 체크리스트](#5-설정-확인-체크리스트)

> **💡 빠른 참조**: [빠른 참조 가이드](CLIENT_SETUP_QUICK_REFERENCE.md)를 먼저 확인하세요.

---

## 1. AWS Route 53 DNS 설정

### 1.1 Route 53 호스팅 영역 확인

> **현재 상태**: `iam-vet.com` 호스팅 영역이 이미 생성되어 있습니다.

1. **AWS 콘솔 접속**
   - https://console.aws.amazon.com 접속
   - 로그인 후 Route 53 서비스 선택

2. **호스팅 영역 확인**
   - 왼쪽 메뉴에서 "호스팅 영역" 클릭
   - `iam-vet.com` 호스팅 영역 선택
   - 레코드 목록이 표시됩니다

3. **현재 레코드 확인**
   - 현재 15개의 레코드가 등록되어 있습니다
   - A 레코드 2개를 수정해야 합니다:
     - `iam-vet.com` A 레코드 (현재: `54.180.160.82`)
     - `www.iam-vet.com` A 레코드 (현재: `216.198.79.1`)

### 1.2 A 레코드 수정 (루트 도메인)

> **현재 상태**: `iam-vet.com` A 레코드가 `54.180.160.82`로 설정되어 있습니다.
> **변경 필요**: `3.38.238.205` (EC2 Elastic IP)로 변경해야 합니다.

1. **기존 A 레코드 찾기**
   - `iam-vet.com` 호스팅 영역 선택
   - 레코드 목록에서 **레코드 이름**이 `iam-vet.com`이고 **유형**이 `A`인 레코드 찾기
   - 현재 값이 `54.180.160.82`로 표시되어 있을 것입니다

2. **레코드 편집**
   - 해당 A 레코드의 체크박스 선택
   - "편집" 버튼 클릭

3. **레코드 값 변경**
   - **레코드 이름**: `iam-vet.com` (변경하지 않음)
   - **레코드 유형**: `A` (변경하지 않음)
   - **값/트래픽 라우팅 대상**: 
     - 기존 값 `54.180.160.82` 삭제
     - 새 값 입력: `3.38.238.205` (EC2 Elastic IP)
   - **TTL**: `300` (5분) 또는 기존 값 유지
   - "변경 사항 저장" 클릭

### 1.3 A 레코드 수정 (www 서브도메인)

> **현재 상태**: `www.iam-vet.com` A 레코드가 `216.198.79.1`로 설정되어 있습니다.
> **변경 필요**: `3.38.238.205` (EC2 Elastic IP)로 변경해야 합니다.

1. **기존 A 레코드 찾기**
   - 레코드 목록에서 **레코드 이름**이 `www.iam-vet.com`이고 **유형**이 `A`인 레코드 찾기
   - 현재 값이 `216.198.79.1`로 표시되어 있을 것입니다

2. **레코드 편집**
   - 해당 A 레코드의 체크박스 선택
   - "편집" 버튼 클릭

3. **레코드 값 변경**
   - **레코드 이름**: `www.iam-vet.com` (변경하지 않음)
   - **레코드 유형**: `A` (변경하지 않음)
   - **값/트래픽 라우팅 대상**: 
     - 기존 값 `216.198.79.1` 삭제
     - 새 값 입력: `3.38.238.205` (EC2 Elastic IP)
   - **TTL**: `300` (5분) 또는 기존 값 유지
   - "변경 사항 저장" 클릭

### ⚠️ 중요: 기존 레코드 유지

다음 레코드들은 **변경하거나 삭제하지 마세요**:
- **MX 레코드**: 이메일 서비스용
- **TXT 레코드**: Google 사이트 인증, DMARC 설정
- **CNAME 레코드**: ACM 인증서, DKIM, 기타 서비스용
- **NS, SOA 레코드**: DNS 기본 설정 (자동 생성)
- **api-dev.iam-vet.com, api.iam-vet.com, service.iam-vet.com**: 기타 서비스용

**변경해야 할 레코드**: `iam-vet.com` A 레코드와 `www.iam-vet.com` A 레코드만 변경하세요.

### 1.4 DNS 전파 확인

설정 후 몇 시간 후에 다음 명령어로 확인할 수 있습니다:

```bash
# Windows (PowerShell 또는 CMD)
nslookup iam-vet.com
nslookup www.iam-vet.com

# Mac/Linux
dig iam-vet.com
dig www.iam-vet.com
```

**예상 결과**: `3.38.238.205`로 응답해야 합니다.

### 1.5 접속 테스트

DNS 전파가 완료된 후:

1. **HTTP 접속 테스트**
   - `http://iam-vet.com` 또는 `http://3.38.238.205`로 접속
   - 정상 작동하면 DNS 전파 완료

2. **HTTPS 접속 오류 발생 시**
   - `ERR_CONNECTION_REFUSED` 오류는 SSL 인증서가 설정되지 않아서 발생할 수 있습니다
   - **Let's Encrypt는 무료 SSL 인증서**를 제공하므로 추가 결제가 필요 없습니다
   - 개발팀에 SSL 인증서 설정을 요청하세요
   - 또는 [문제 해결 가이드](TROUBLESHOOTING.md)를 참조하세요

---

## 2. 카카오 개발자 콘솔 설정

### 2.1 카카오 개발자 콘솔 접속

1. **개발자 콘솔 접속**
   - https://developers.kakao.com 접속
   - 카카오 계정으로 로그인

2. **내 애플리케이션 선택**
   - 사용 중인 애플리케이션 선택

### 2.2 플랫폼 설정

1. **플랫폼 메뉴 이동**
   - 왼쪽 메뉴에서 "앱 설정" > "플랫폼" 선택

2. **웹 플랫폼 추가/수정**
   - "플랫폼 추가" 버튼 클릭 (웹이 없는 경우)
   - 또는 기존 웹 플랫폼 선택
   - **사이트 도메인**: `iam-vet.com` 입력
   - 저장

### 2.3 Redirect URI 변경

1. **카카오 로그인 활성화**
   - 왼쪽 메뉴에서 "제품 설정" > "카카오 로그인" 선택
   - "활성화 설정"에서 "ON"으로 설정

2. **Redirect URI 설정**
   - "Redirect URI" 섹션으로 이동
   - 기존 Vercel 도메인 URI 제거 (있는 경우)
   - "URI 추가" 버튼 클릭
   - 다음 URI 추가:
     ```
     https://iam-vet.com/api/auth/kakao/callback
     ```
   - 저장

### 2.4 동의 항목 확인

1. **동의 항목 메뉴 이동**
   - 왼쪽 메뉴에서 "제품 설정" > "카카오 로그인" > "동의항목" 선택

2. **필수 동의 항목 확인**
   - 이메일, 닉네임 등 필요한 동의 항목이 설정되어 있는지 확인

### 2.5 설정 확인

- **앱 키 확인**
  - "앱 설정" > "앱 키" 메뉴에서
  - REST API 키 확인 (필요한 경우)

---

## 3. 구글 클라우드 콘솔 설정

### 3.1 구글 클라우드 콘솔 접속

1. **콘솔 접속**
   - https://console.cloud.google.com 접속
   - 구글 계정으로 로그인

2. **프로젝트 선택**
   - 상단의 프로젝트 선택 드롭다운에서 해당 프로젝트 선택

### 3.2 OAuth 동의 화면 설정

1. **OAuth 동의 화면 메뉴 이동**
   - 왼쪽 메뉴에서 "API 및 서비스" > "OAuth 동의 화면" 선택

2. **승인된 도메인 추가**
   - "승인된 도메인" 섹션으로 이동
   - "도메인 추가" 버튼 클릭
   - `iam-vet.com` 입력
   - 저장

### 3.3 사용자 인증 정보 설정

1. **사용자 인증 정보 메뉴 이동**
   - 왼쪽 메뉴에서 "API 및 서비스" > "사용자 인증 정보" 선택

2. **OAuth 2.0 클라이언트 ID 선택**
   - 기존 OAuth 2.0 클라이언트 ID 선택 (또는 새로 생성)

3. **승인된 리디렉션 URI 수정**
   - "승인된 리디렉션 URI" 섹션으로 이동
   - 기존 Vercel 도메인 URI 제거 (있는 경우):
     ```
     https://[vercel-domain]/api/auth/google/callback
     ```
   - "URI 추가" 버튼 클릭
   - 다음 URI 추가:
     ```
     https://iam-vet.com/api/auth/google/callback
     ```
   - 저장

### 3.4 JavaScript 원본 설정 (필요한 경우)

1. **승인된 JavaScript 원본 확인**
   - "승인된 JavaScript 원본" 섹션 확인
   - 필요시 다음 추가:
     ```
     https://iam-vet.com
     https://www.iam-vet.com
     ```

### 3.5 설정 확인

- **클라이언트 ID 및 클라이언트 보안 비밀번호 확인**
  - 사용자 인증 정보 페이지에서 확인 가능

---

## 4. 네이버 개발자 센터 설정

### 4.1 네이버 개발자 센터 접속

1. **개발자 센터 접속**
   - https://developers.naver.com 접속
   - 네이버 계정으로 로그인

2. **내 애플리케이션 선택**
   - "내 애플리케이션" 메뉴에서 사용 중인 애플리케이션 선택

### 4.2 API 설정

1. **API 설정 메뉴 이동**
   - 왼쪽 메뉴에서 "API 설정" 선택

2. **서비스 URL 변경**
   - **서비스 URL**: `https://iam-vet.com` 입력
   - 저장

3. **Callback URL 변경**
   - **Callback URL**: `https://iam-vet.com/api/auth/naver/callback` 입력
   - 저장

### 4.3 환경 설정 확인

1. **환경 설정 메뉴 확인**
   - "환경 설정" 메뉴에서
   - 서비스 환경이 "서비스"로 설정되어 있는지 확인

### 4.4 설정 확인

- **클라이언트 ID 및 클라이언트 시크릿 확인**
  - API 설정 페이지에서 확인 가능

---

## 5. 설정 확인 체크리스트

### AWS Route 53

- [ ] 호스팅 영역 생성 완료 (`iam-vet.com`)
- [ ] 네임서버 변경 완료 (다른 등록 기관 사용 시)
- [ ] A 레코드 생성 완료 (루트 도메인 → `3.38.238.205`)
- [ ] A 레코드 생성 완료 (www → `3.38.238.205`)
- [ ] DNS 전파 확인 (최대 48시간 소요)

### 카카오 개발자 콘솔

- [ ] 웹 플랫폼 추가/수정 완료
- [ ] 사이트 도메인: `iam-vet.com` 설정
- [ ] Redirect URI: `https://iam-vet.com/api/auth/kakao/callback` 추가
- [ ] 카카오 로그인 활성화 확인

### 구글 클라우드 콘솔

- [ ] 승인된 도메인: `iam-vet.com` 추가
- [ ] 승인된 리디렉션 URI: `https://iam-vet.com/api/auth/google/callback` 추가
- [ ] 기존 Vercel URI 제거 확인

### 네이버 개발자 센터

- [ ] 서비스 URL: `https://iam-vet.com` 변경
- [ ] Callback URL: `https://iam-vet.com/api/auth/naver/callback` 변경
- [ ] 환경 설정이 "서비스"로 설정되어 있는지 확인

---

## ⚠️ 중요 사항

### 변경 사항 반영 시간

- **DNS 전파**: 최대 48시간 (보통 몇 시간 내)
- **OAuth 설정**: 즉시 반영 (일부 서비스는 몇 분 소요)

### 테스트 방법

설정 완료 후 다음 URL로 접속하여 테스트:

1. **메인 페이지**: https://iam-vet.com
2. **카카오 로그인**: 로그인 페이지에서 카카오 로그인 버튼 클릭
3. **구글 로그인**: 로그인 페이지에서 구글 로그인 버튼 클릭
4. **네이버 로그인**: 로그인 페이지에서 네이버 로그인 버튼 클릭

### 문제 발생 시

1. **DNS 전파 확인**
   ```bash
   nslookup iam-vet.com
   ```

2. **OAuth 리다이렉트 URI 확인**
   - 각 개발자 콘솔에서 URI가 정확히 입력되었는지 확인
   - 공백이나 오타가 없는지 확인

3. **브라우저 캐시 삭제**
   - 브라우저 캐시를 삭제하고 다시 시도

---

## 📞 문의

설정 중 문제가 발생하거나 도움이 필요한 경우 개발팀에 문의해주세요.

